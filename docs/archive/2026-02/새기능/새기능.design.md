# Design: 애니메이션 효과 (새기능)

## 참조
- Plan: `docs/01-plan/features/새기능.plan.md`
- 작성일: 2026-02-21

---

## 1. 아키텍처 설계

### 라이브러리 선택: `framer-motion`
- React 선언적 API (`motion.div`, `whileInView`, `initial`, `animate`)
- SSR 지원 (Next.js App Router 호환)
- `viewport={{ once: true }}` — 섹션이 한 번만 애니메이션 실행
- `prefers-reduced-motion` 자동 감지 내장 (`useReducedMotion` 훅)

### 데이터 흐름
```
페이지 로드
    ↓
Hero 섹션 → motion.div initial(opacity:0, y:20) → animate(opacity:1, y:0)
    ↓
스크롤 이동
    ↓
Intersection Observer (whileInView)
    ↓
섹션별 fade-in / SkillBar width 0→value
    ↓
hover 이벤트
    ↓
ProjectCard → whileHover scale(1.01) + shadow
```

### 접근성 전략
```tsx
const shouldReduce = useReducedMotion();
const variants = shouldReduce ? {} : fadeInVariants;
```
- `prefers-reduced-motion: reduce` 환경에서 variants 비활성화
- 모든 시각적 효과는 기능에 영향 없이 적용/미적용 가능

---

## 2. 공유 Animation Variants

### `lib/animations.ts` (신규)
```ts
import type { Variants } from "framer-motion";

export const fadeInUp: Variants = {
  hidden: { opacity: 0, y: 16 },
  visible: {
    opacity: 1,
    y: 0,
    transition: { duration: 0.5, ease: "easeOut" },
  },
};

export const fadeIn: Variants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: { duration: 0.4, ease: "easeOut" },
  },
};

export const staggerContainer: Variants = {
  hidden: {},
  visible: {
    transition: { staggerChildren: 0.08 },
  },
};
```

---

## 3. 파일별 변경 명세

### 3.1 `package.json`
```bash
pnpm add framer-motion
```

### 3.2 `lib/animations.ts` (신규)
공유 Variants 정의 (위 섹션 2 참조)

### 3.3 `app/page.tsx`

#### Hero 섹션 (About)
```diff
- import { PortfolioLayout } from "@/components/templates/PortfolioLayout";
+ import { PortfolioLayout } from "@/components/templates/PortfolioLayout";
+ import { AnimatedSection, HeroContent } from "@/components/templates/AnimatedSection";
```

> `app/page.tsx`는 Server Component 유지. 클라이언트 애니메이션은 별도 wrapper 컴포넌트로 분리.

#### 섹션 구조 변경
```diff
- <section id="about" className="py-24 border-b ...">
-   <div className="mb-2">...
+ <AnimatedSection id="about" className="py-24 border-b ..." delay={0}>
+   <div className="mb-2">...
```
- 모든 `<section>`을 `<AnimatedSection>`으로 교체
- `delay` prop으로 순차 등장 제어

### 3.4 `components/templates/AnimatedSection.tsx` (신규)

```tsx
"use client";

import { motion, useReducedMotion } from "framer-motion";
import { fadeInUp } from "@/lib/animations";

type AnimatedSectionProps = {
  id?: string;
  className?: string;
  delay?: number;
  children: React.ReactNode;
};

export function AnimatedSection({ id, className, delay = 0, children }: AnimatedSectionProps) {
  const shouldReduce = useReducedMotion();

  return (
    <motion.section
      id={id}
      className={className}
      variants={shouldReduce ? undefined : fadeInUp}
      initial="hidden"
      whileInView="visible"
      viewport={{ once: true, margin: "-80px" }}
      transition={{ delay }}
    >
      {children}
    </motion.section>
  );
}
```

### 3.5 `components/atoms/SkillBar.tsx`

**변경 전**: `style={{ width: `${level}%` }}` — 항상 즉시 full width

**변경 후**: Framer Motion으로 0 → level% 애니메이션

```diff
+ "use client";
+ import { motion, useReducedMotion } from "framer-motion";

  export function SkillBar({ name, level, category }: SkillBarProps) {
+   const shouldReduce = useReducedMotion();

    return (
      <div className="mb-4">
        ...
        <div className="h-1 bg-neutral-100 dark:bg-neutral-800 rounded-full overflow-hidden">
-         <div
-           className="h-full bg-neutral-800 dark:bg-neutral-200 rounded-full transition-all duration-700"
-           style={{ width: `${level}%` }}
-         />
+         <motion.div
+           className="h-full bg-neutral-800 dark:bg-neutral-200 rounded-full"
+           initial={{ width: 0 }}
+           whileInView={{ width: shouldReduce ? `${level}%` : `${level}%` }}
+           transition={shouldReduce ? { duration: 0 } : { duration: 0.8, ease: "easeOut", delay: 0.1 }}
+           viewport={{ once: true, margin: "-40px" }}
+         />
        </div>
        ...
      </div>
    );
  }
```

> `"use client"` 추가 필요 (motion 훅 사용)

### 3.6 `components/molecules/ProjectCard.tsx`

**변경 전**: 테두리 색상만 hover 변경

**변경 후**: scale + shadow hover 추가

```diff
+ "use client";
+ import { motion } from "framer-motion";

  export function ProjectCard({ project }: ProjectCardProps) {
    return (
-     <div className="border border-neutral-200 dark:border-neutral-800 p-6 hover:border-neutral-400 dark:hover:border-neutral-600 transition-colors duration-200">
+     <motion.div
+       className="border border-neutral-200 dark:border-neutral-800 p-6"
+       whileHover={{ scale: 1.01, boxShadow: "0 4px 20px rgba(0,0,0,0.06)" }}
+       transition={{ duration: 0.2, ease: "easeOut" }}
+     >
        ...
-     </div>
+     </motion.div>
    );
  }
```

> 기존 `hover:border-*` Tailwind 클래스는 제거하고 motion 제어로 통일

### 3.7 `components/organisms/Header.tsx`

**변경 전**: 스크롤 시 배경 transition만 존재

**변경 후**: 초기 로드 시 fade-in 추가

```diff
+ import { motion } from "framer-motion";

  return (
-   <header className={`fixed top-0 ...`}>
+   <motion.header
+     className={`fixed top-0 ...`}
+     initial={{ opacity: 0, y: -8 }}
+     animate={{ opacity: 1, y: 0 }}
+     transition={{ duration: 0.4, ease: "easeOut" }}
+   >
      ...
-   </header>
+   </motion.header>
  );
```

---

## 4. 타입 정의

```ts
// AnimatedSection props
type AnimatedSectionProps = {
  id?: string;
  className?: string;
  delay?: number;        // 등장 지연 (초)
  children: React.ReactNode;
};
```

---

## 5. 구현 순서

1. `pnpm add framer-motion`
2. `lib/animations.ts` 생성 (공유 variants)
3. `components/templates/AnimatedSection.tsx` 생성
4. `components/atoms/SkillBar.tsx` — motion.div + `"use client"` 추가
5. `components/molecules/ProjectCard.tsx` — motion.div + `"use client"` 추가
6. `components/organisms/Header.tsx` — motion.header 로드 애니메이션
7. `app/page.tsx` — section → AnimatedSection 교체
8. `pnpm tsc --noEmit` 타입체크
9. `pnpm build` 빌드 확인
10. 브라우저에서 스크롤/hover 확인

---

## 6. 완료 기준 (검증)

| 검증 항목 | 방법 |
|-----------|------|
| Hero 로드 애니메이션 | 페이지 진입 시 fadeUp 확인 |
| 섹션 fade-in | 스크롤 진입 시 opacity 0→1 확인 |
| SkillBar fill | 스킬 섹션 스크롤 시 바가 채워지는 확인 |
| ProjectCard hover | 카드 hover 시 scale+shadow 확인 |
| Header 로드 | 첫 로드 시 Header fade-in 확인 |
| reduced-motion | OS 설정에서 애니메이션 감소 시 즉시 표시 |
| 빌드 성공 | `pnpm build` 오류 없음 |
| 타입 오류 없음 | `pnpm tsc --noEmit` 통과 |
